![SmashEx Logo](smashex.png)

***SmashEx*** PoC Exploits for Intel SGX Frameworks based on Intel SGX SDK
==============================================================

***SmashEx***: Smashing SGX Enclaves Using Exceptions

**NOTE**: This repository is only an entry of PoCs of the SGX framewroks tested with ***SmashEx***. One can go to different repositories for your interests, in which we have shown a step-by-step guide to reproduce the ***SmashEx*** attacks.

**NOTE**: Other PoCs of SGX frameworks based on Microsoft Open Enclave SDK can be found at [here](https://github.com/jasonyu1996/sigex-teaclave-attack).

# What is SmashEx?
***SmashEx*** is a new attack which exploits the OS-enclave interface on SGX for asynchronous exceptions and the exception handling mechanism. The attack observed a missing feature and an unsafe code design: the lack of safe atomic execution primitives on this interface and the use of untrusted stack in exception handling, respectively. In the absence of atomicity and secure design, we show that asynchronous exception handling in SGX enclaves is complicated and prone to re-entrancy vulnerabilities. Our attacks do not assume any memory errors in the enclave code, side-channels, or application-specific logic flaws. We concretely demonstrate exploits that cause arbitrary disclosure of enclave private memory and code execution in the enclave. We show reliable exploits on two widely-used SGX runtimes, Intel SGX SDK and Microsoft Open Enclave, running OpenSSL and cURL libraries respectively. We discuss how the vulnerability manifests across both versions v1 and v2 of SGX, and extends to several other SGX runtimes such as Google Asylo, Apache Teaclave as well as Rust SGX SDK, Edgeless RT, and so on. We also discuss potential mitigations and long-term defenses for SmashEx.

# Getting help
For any questions or bugs, please send an email to jhcui.gid@gmail.com, or post your issues on the GitHub repository.

